language: ruby
sudo: false
cache: bundler
rvm:
  - 2.3.0
branches:
  only:
  - solidus-taxation
before_script:
  - sh -e /etc/init.d/xvfb start
  - export DISPLAY=:99.0
bundler_args: --without development production
env:
  - GEM=api DB=postgres
  - GEM=backend DB=postgres
  - GEM=core DB=postgres
  - GEM=frontend DB=postgres
  - GEM=sample DB=postgres
before_install:
  - cd $GEM; export BUNDLE_GEMFILE="`pwd`/Gemfile"
script:
  - bundle exec rake test_app
  - bundle exec rake spec
